import telebot
import requests

# Apna bot token yahan daalein
TELEGRAM_BOT_TOKEN = '8290264167:AAErNnCsh95i83um-EL1zeUeyByCZOF007c'
REQUIRED_CHANNEL = "@Jahanzaibbaloch1"  # Apna channel username

bot = telebot.TeleBot(TELEGRAM_BOT_TOKEN)

# Channel join check
def is_user_member(user_id):
    try:
        member = bot.get_chat_member(REQUIRED_CHANNEL, user_id)
        return member.status in ['member', 'administrator', 'creator']
    except:
        return False

@bot.message_handler(commands=['start'])
def start_message(message):
    if not is_user_member(message.from_user.id):
        bot.send_message(message.chat.id, f"🚫 Please join our channel first:\n{REQUIRED_CHANNEL}")
        return
    bot.send_message(message.chat.id, "✅ Bot Active!\nCommands:\n/bin 411111\n/gen")

@bot.message_handler(commands=['bin'])
def bin_lookup(message):
    if not is_user_member(message.from_user.id):
        bot.send_message(message.chat.id, f"🚫 Join first: {REQUIRED_CHANNEL}")
        return

    try:
        bin_number = message.text.split()[1]
        response = requests.get(f"https://lookup.binlist.net/{bin_number}")
        if response.status_code == 200:
            data = response.json()
            reply = f"""💳 BIN Info: {bin_number}
🏦 Bank: {data.get('bank', {}).get('name', 'N/A')}
🌐 Country: {data.get('country', {}).get('name', 'N/A')}
💼 Scheme: {data.get('scheme', 'N/A').upper()}
📶 Type: {data.get('type', 'N/A').upper()}"""
        else:
            reply = "❌ BIN not found or invalid."
    except IndexError:
        reply = "⚠️ Use correct format:\n/bin 411111"
    except Exception as e:
        reply = f"⚠️ Error: {str(e)}"
    bot.send_message(message.chat.id, reply)

@bot.message_handler(commands=['gen'])
def generate_card(message):
    if not is_user_member(message.from_user.id):
        bot.send_message(message.chat.id, f"🚫 Join first: {REQUIRED_CHANNEL}")
        return
    reply = """💳 Test Card (Stripe):
4242 4242 4242 4242 | 12/30 | 123
💡 Use only for legal and testing purposes."""
    bot.send_message(message.chat.id, reply)

bot.polling()